#!/usr/bin/env python3
import binascii
aim = binascii.unhexlify('01 02 03 04 C8 87 A2 A1  D5 42 29 EF BD C9 6C 8D EF ED 4E C7 5C 33 D6 E7  5B 3E 8F AA 38 DD 08 FF 9F'.replace(' ', ''))
aim = bytearray(aim)

aim[0] = (ord('G') - 0x59) & 0xff
aim[1] = (ord('H') - 0x54) & 0xff
aim[2] = (ord('1') + 0x2a) & 0xff
aim[3] = (ord('9') - 0x56) & 0xff

if 0:
    aim[0] = (ord('+') - 0x59) & 0xff
    aim[1] = (1 - 0x54) & 0xff
    aim[2] = (ord(',') + 0x2a) & 0xff
    aim[3] = (3 - 0x56) & 0xff

g_SUBST = binascii.unhexlify('''
04 14 09 1F 05 15 19 17  1E 02 06 08 10 1A 00 03
0D 0F 0C 0E 01 1D 13 11  1B 07 12 16 0B 18 0A 1C
0C 01 12 1C 16 15 1B 17  05 1E 06 14 0A 19 0B 11
1A 18 0E 0D 02 09 1D 13  00 03 04 07 08 0F 1F 10
1F 00 0D 1D 1E 1B 08 13  19 1C 11 0A 15 17 03 0B
02 05 06 12 0E 0F 18 09  16 1A 01 10 0C 14 07 04
15 14 19 1B 1C 12 02 00  11 16 17 0E 06 09 01 05
1E 1F 18 07 13 04 0F 0D  1D 1A 08 10 0B 0C 0A 03
39 B3 C7 43 08 5D FF 50  E2 7B FC 79 45 F7 2E 13
65 A8 BF 35 49 AE 99 7F  8F FA 0B 3C 0F 28 D8 EA
DA C9 57 CE 21 C4 E1 66  40 5E 19 C3 F2 A2 4C CC
53 64 32 5B C8 B0 C6 90  4E EB 9F 8D A7 E3 05 C2
1B D1 24 F3 86 AF 6C 56  CB C5 03 F4 B7 F1 9C 71
DD 46 8B D4 4D 2B 58 6E  37 14 60 88 B5 44 84 59
DE 96 12 3B 6D E6 FB D0  A1 11 00 BA 8E C0 BB 80
55 CF AD 9B 6B 33 0A 23  09 D5 F9 B1 2C E0 17 D6
75 87 AA FD A9 76 CD 7D  3F 41 93 BD 67 10 4A 38
0E 54 1D 94 4F 2D 7C 36  D7 89 29 06 5F F8 97 BC
CA B6 63 52 1F A4 EE E5  7A 26 81 A0 0D 6A F6 DC
DF 18 25 8C 9D A5 D9 BE  AC 77 2A FE 1E B2 2F 85
B4 9A 1C 47 A6 E4 68 95  EF 42 83 48 02 22 98 3A
9E 15 92 E7 DB 82 01 78  3D ED 3E F0 51 8A D3 A3
69 E9 73 31 04 20 5C 61  4B 34 B9 AB 7E C1 62 0C
6F 07 30 91 1A D2 16 E8  EC 74 B8 27 F5 72 5A 70
0D 02 13 16 07 0C 00 11  10 09 19 1F 1C 04 18 06
14 0F 15 0B 12 1A 0A 05  1B 1E 08 17 01 0E 03 1D
FC ED F2 E0 F5 EB FA E5  E3 F3 FE F6 EE F0 E8 E4
E9 E6 F8 FB E1 EC EA E2  E7 F9 F7 EF F4 FD F1 FF
E7 E3 E9 E1 F5 F6 EA EE  FA E6 E0 F3 E4 E5 F7 FD
FE FC EB FB F2 F8 E2 EF  F1 ED FF F0 EC E8 F4 F9
F8 E0 EF F1 E7 F0 F5 EC  F9 FC FB F3 F4 EB FE FA
ED F6 F7 FF E6 E8 EA E2  E4 FD E3 EE F2 E9 E5 E1
'''.replace(' ', '').replace('\n', ''))[128:0x180]
g_SUBST2 = binascii.unhexlify('''
73 E8 80 59 0C 64 BE BC  5F E4 E0 9D 28 6D 77 D7
65 34 BB D4 A4 70 9E 10  29 56 C3 88 BF 00 D3 3B
6E BF 85 D6 70 2D 9E 21  B2 48 E0 CC 31 90 2D B6
34 E6 2F BA 1F BD F6 95  7E 9B E1 D5 26 E0 A4 34
6E 18 F6 60 D0 06 44 17  84 F9 06 10 10 05 79 00
AF BA B6 0F 7C 55 95 AD  EB 88 5B 3A C0 3D 18 C7
7E 3A BA 21 1A EC B8 90  F3 97 60 75 89 04 FD 4B
F6 17 00 08 BE EF 35 01  88 1D B4 86 A8 27 AF A6
2A 01 2C 03 2E 05 30 07  32 09 34 0B 36 0D 38 0F
3A 11 3C 13 3E 15 40 17  42 19 44 1B 46 1D 48 1F
4A 21 4C 23 4E 25 50 27  52 29 54 2B 56 2D 58 2F
5A 31 5C 33 5E 35 60 37  62 39 64 3B 66 3D 68 3F
6A 41 6C 43 6E 45 70 47  72 49 74 4B 76 4D 78 4F
7A 51 7C 53 7E 55 80 57  82 59 84 5B 86 5D 88 5F
8A 61 8C 63 8E 65 90 67  92 69 94 6B 96 6D 98 6F
9A 71 9C 73 9E 75 A0 77  A2 79 A4 7B A6 7D A8 7F
AA 81 AC 83 AE 85 B0 87  B2 89 B4 8B B6 8D B8 8F
BA 91 BC 93 BE 95 C0 97  C2 99 C4 9B C6 9D C8 9F
CA A1 CC A3 CE A5 D0 A7  D2 A9 D4 AB D6 AD D8 AF
DA B1 DC B3 DE B5 E0 B7  E2 B9 E4 BB E6 BD E8 BF
EA C1 EC C3 EE C5 F0 C7  F2 C9 F4 CB F6 CD F8 CF
FA D1 FC D3 FE D5 00 D7  02 D9 04 DB 06 DD 08 DF
0A E1 0C E3 0E E5 10 E7  12 E9 14 EB 16 ED 18 EF
1A F1 1C F3 1E F5 20 F7  22 F9 24 FB 26 FD 28 FF
BE 33 42 39 27 FB 74 9D  AE A4 4E E2 92 13 02 0F
12 B9 BC 29 B4 96 CE 1C  02 B5 54 33 F2 07 03 F3
7B 18 13 D5 13 0E 73 46  3B DB 1B 55 D2 5F 80 C9
03 99 F8 13 9A 27 97 18  76 70 31 28 F9 5B BB C7
97 A8 35 23 47 7E 64 FC  AC F8 D2 90 52 46 0E A8
4A 0A 94 2A BC 1F 6E 39  EC 5C 19 B4 4A BF 6E 81
F4 92 52 74 14 41 5D 32  BF 3C DC 1A 5D 1C 04 61
25 E0 6A D9 6D 63 A2 37  84 F6 4C 58 32 4A EE 03
'''.replace(' ', '').replace('\n', ''))[128:0x180]
assert len(g_SUBST) == 256
rv = dict((y, x) for x, y in enumerate(g_SUBST))
assert len(rv) == 256
rv_2 = dict((y, x) for x, y in enumerate(g_SUBST2))
assert len(rv_2) == 256


for idx in range(len(aim) - 1, -1, -1):
    for i in range(len(aim)):
        aim[i] ^= g_SUBST2[(i + idx) & 0xff]
    if idx + 1< len(aim):
        aim[idx] = (aim[idx] - aim[idx + 1]) & 0xff
    for i in range(len(aim)):
        aim[i] = rv[aim[i]]
        aim[i] = ((aim[i] << 5) | (aim[i] >> 3))&0xff
    print(aim)
